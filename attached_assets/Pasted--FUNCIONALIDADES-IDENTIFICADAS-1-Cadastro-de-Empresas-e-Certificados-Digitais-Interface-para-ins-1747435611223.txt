‚ùÅ FUNCIONALIDADES IDENTIFICADAS

1. Cadastro de Empresas e Certificados Digitais

Interface para inser√ß√£o de dados da empresa:

Raz√£o Social, Nome Fantasia, CNPJ, Inscri√ß√£o Estadual, CNAE

Regime tribut√°rio, tipo de emissor, modelo

Upload de certificado digital A1 (.pfx)

Armazenamento seguro com senha vinculada

Valida√ß√£o da data de validade e status do certificado

2. Cadastro de Produtos

Campos:

Descri√ß√£o, NCM, CFOP, C√≥digo interno, CST/CSOSN

Unidade de medida, Pre√ßo de venda, Pre√ßo de custo

Estoque, CST IPI, Al√≠quotas ICMS/PIS/COFINS

Fun√ß√£o de importador de produtos via planilha

3. Cadastro de Clientes

CPF/CNPJ, nome/raz√£o social, endere√ßo completo, email

Tipo de contribuinte, estado, pa√≠s, inscri√ß√£o estadual

Op√ß√£o para consumidor final ou contribuinte isento

4. Emiss√£o de NF-e

Tela de emiss√£o baseada em sele√ß√£o de cliente e produtos

Campos autom√°ticos:

Natureza da opera√ß√£o, modelo, s√©rie, n√∫mero

Forma de pagamento, transporte, volume, frete

C√°lculo autom√°tico de tributos e totais

Gera√ß√£o de XML conforme leiaute SEFAZ

Valida√ß√£o de schema antes do envio

Envio via webservice com SOAP

Retorno de protocolo e status

Impress√£o da DANFE (PDF)

5. Consulta de NF-e Emitidas

Listagem por filtros: cliente, data, status, n√∫mero

A√ß√µes:

Reenviar NF-e

Baixar XML

Visualizar DANFE

Cancelar NF-e (com justificativa)

Inutiliza√ß√£o de numera√ß√£o

6. Integra√ß√£o com SEFAZ

Certificado A1 utilizado para autentica√ß√£o

Webservices para:

Envio da NF-e

Consulta de protocolo

Cancelamento

Inutiliza√ß√£o

URL por estado e ambiente (homologa√ß√£o/produ√ß√£o)

Gerador de QR Code para NFC-e (quando aplic√°vel)

7. Gera√ß√£o e Valida√ß√£o de XML

Classes que geram XML em conformidade com vers√£o 4.00

Mapeamento dos campos obrigat√≥rios e condi√ß√µes de presen√ßa

Estrutura modular: emitente, destinat√°rio, produtos, totais, transporte, pagamentos

Valida√ß√£o contra XSD da SEFAZ

8. Envio de Documentos

Envio de DANFE e XML por e-mail para o cliente

Integra√ß√£o com API de WhatsApp (via endpoint externo)

9. Logs e Hist√≥rico

Logs armazenados por nota:

Hora da transmiss√£o

Status SEFAZ

C√≥digo de retorno

Eventos posteriores (cancelamento, carta de corre√ß√£o)

‚úçÔ∏è ARQUIVOS DE DESTAQUE (EXTRA√á√ÉO)

nfe_emitir.php: tela de emiss√£o da NF com sele√ß√£o de cliente, produtos, tributa√ß√£o

certificado_upload.php: upload do certificado A1

funcoes/xml_generator.php: cria√ß√£o do XML da NF-e

funcoes/sefaz_client.php: envio do XML via SOAP

danfe.php: gera√ß√£o da DANFE em PDF

ajax/consulta_nf.php: busca notas emitidas

üîó ESTRUTURA DE CAMPOS COMUNS (NF-E)

Emitente: CNPJ, IE, IM, Raz√£o Social, Endere√ßo, Regime Tribut√°rio

Destinat√°rio: CPF/CNPJ, Nome/Raz√£o, Endere√ßo, IE, Email

Produtos: C√≥digo, NCM, CFOP, CST, Unidade, Quantidade, Valor Unit√°rio, Al√≠quotas

Totais: Base ICMS, Valor ICMS, PIS, COFINS, Total NF

Transporte: Modal, Transportadora, Volume, Peso

Pagamentos: Forma, Valor, Condi√ß√£o

üåê SUGEST√ÉO DE INTEGRA√á√ÉO EM NOVO SISTEMA (REPLIT/OUTROS)

Reaproveitar as classes de gera√ß√£o de XML e integra√ß√£o com SEFAZ

Criar APIs REST para opera√ß√µes (emitir, cancelar, consultar)

Utilizar frontend moderno (React ou Vue) com formul√°rios din√¢micos

Utilizar JWT para autentica√ß√£o de clientes e colabores

Banco de dados: PostgreSQL com rela√ß√µes empresa-clientes-notas

Upload seguro e criptografado de certificados